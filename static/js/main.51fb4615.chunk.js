(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t){},110:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(33),c=n.n(o),s=n(4),i=n(5),u=n(7),l=n(6),p=n(8),h=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={clicked:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.onClick,r=e.style,o=this.props.disabled?"disabled":"",c=this.props.light?"light":"",s="button unselectable ".concat(o," ").concat(c);return a.a.createElement("div",{className:s,style:r,onClick:n},t)}}]),t}(r.Component),f=n(113),m=n(116),d=n(112),v=n(114),b=n(115),w=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._goHome=function(){n.props.history.replace("/sync")},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"centered"},a.a.createElement("h1",null,"404 - Page not found"),a.a.createElement("p",null,"It looks like you are lost"),a.a.createElement("div",null,a.a.createElement(h,{title:"Go Home",onClick:this._goHome})))}}]),t}(r.Component),k=Object(b.a)(w),x=n(1),O=n.n(x),y=n(3),j=n(13),g=n.n(j),E="http://localhost:8080",C=function(e){return"https://".concat(e,".ngrok.io")},R=new RegExp("//.[^.]*"),T=function(){return localStorage.getItem("bearer")},M={Bearer:T,closeRoom:function(){var e=Object(y.a)(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=T(),localStorage.removeItem("bearer"),e.next=4,g()({url:"".concat(E,"/room/close"),method:"POST",headers:{Authorization:"Bearer ".concat(t)}});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),createRoom:function(){var e=Object(y.a)(O.a.mark(function e(){var t,n,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()({url:"".concat(E,"/room/create"),method:"POST"});case 3:return(t=e.sent).data.bearer&&localStorage.setItem("bearer",t.data.bearer),n=R.exec(t.data.url)||[],e.abrupt("return",n.join("").substr(2));case 9:e.prev=9,e.t0=e.catch(0),e.t1=e.t0.response.status,e.next=400===e.t1?14:16;break;case 14:return r=R.exec(e.t0.response.data.url)||[],e.abrupt("return",r.join("").substr(2));case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),getClientType:function(){var e=Object(y.a)(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()({url:E,method:"GET"});case 3:return t=e.sent,e.abrupt("return",200===t.status?"desktop":"web");case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","web");case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),getSocketURL:function(){var e=Object(y.a)(O.a.mark(function e(t){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()({url:"".concat(C(t),"/room/socketTunnel"),method:"GET"});case 3:return e.abrupt("return",C(t));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),setMedia:function(){var e=Object(y.a)(O.a.mark(function e(){var t,n,r,a,o=arguments;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{url:n,file:r},n=t.url,r=t.file,!n){e.next=6;break}return e.next=4,g()({url:"".concat(E,"/room/setMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(T())},data:{url:n}});case 4:e.next=11;break;case 6:if(!r){e.next=11;break}return(a=new FormData).append("media",r),e.next=11,g()({url:"".concat(E,"/room/uploadMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(T())},data:a});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),playMedia:function(){var e=Object(y.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()({url:"".concat(E,"/room/playMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(T())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pauseMedia:function(){var e=Object(y.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()({url:"".concat(E,"/room/pauseMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(T())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setMediaTime:function(){var e=Object(y.a)(O.a.mark(function e(t){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g()({url:"".concat(E,"/room/setMediaTime"),method:"POST",headers:{Authorization:"Bearer ".concat(T())},data:{time:t}});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},S=n(53),B=n.n(S),L=n(54),N=n.n(L)()(B.a),U=function(e){N.fire(e)},_=function(){var e=Object(y.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.fire(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),I={hide:function(){N.close()},show:U,showAction:_,showChoice:function(){var e=Object(y.a)(O.a.mark(function e(){var t,n,r,a,o,c,s,i,u=arguments;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{title:n,text:r,confirmButtonText:o,cancelButtonText:s},n=t.title,r=t.text,a=t.confirmButtonText,o=void 0===a?"Confirm":a,c=t.cancelButtonText,s=void 0===c?"Cancel":c,e.next=3,_({title:n,text:r,type:"info",showCloseButton:!0,showCancelButton:!0,showConfirmButton:!0,cancelButtonText:s,confirmButtonText:o});case 3:return i=e.sent,e.abrupt("return",i.value?0:"cancel"===i.dismiss?1:-1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showAlert:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";U({title:e,text:t,type:"info"})},showError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";U({title:e,text:t,type:"error"})},showInput:function(){var e=Object(y.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({title:t,input:"text",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading";U({allowOutsideClick:!1,allowEscapeKey:!1,title:e,onOpen:function(){return N.showLoading()}})},showURLInput:function(){var e=Object(y.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_({title:t,input:"url",inputPlaceholder:"URL",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},P=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._createRoom=Object(y.a)(O.a.mark(function e(){var t,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,I.showLoading(),e.next=5,M.createRoom();case 5:r=e.sent,t.push("/sync/room/".concat(r),{host:!0}),I.hide(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),I.showError("Unable to Create Room");case 14:case"end":return e.stop()}},e,this,[[1,10]])})),n._joinRoom=Object(y.a)(O.a.mark(function e(){var t,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.next=3,I.showInput("Enter Room ID");case 3:if(!(r=e.sent)){e.next=17;break}return e.prev=5,I.showLoading(),e.next=9,M.getSocketURL(r);case 9:t.push("/sync/room/".concat(r),{host:!1}),I.hide(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0),I.showError("Unable to Join Room","Please ensure the room id specified is correct");case 17:case"end":return e.stop()}},e,this,[[5,13]])})),n.state={web:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(O.a.mark(function e(){var t,n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.props.location).state&&(t.state.roomClosed?I.showAlert("Room Closed"):t.state.roomDoesNotExist&&I.showError("Unable to Join Room","Room does not exist!")),e.prev=2,e.next=5,M.getClientType();case 5:n=e.sent,this.setState({web:"web"===n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.setState({web:!0});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.web;return a.a.createElement("div",{className:"centered"},a.a.createElement("h1",null,"sync"),a.a.createElement("p",null,"The simplest way to watch media together"),a.a.createElement("div",null,a.a.createElement(h,{title:"Join",style:{marginRight:"1em"},onClick:this._joinRoom}),e?a.a.createElement(W,{tooltip:"You must be using the sync client to host a room.",component:a.a.createElement(h,{title:"Host",disabled:!0})}):a.a.createElement(h,{title:"Host",onClick:this._createRoom})))}}]),t}(r.Component),A=Object(b.a)(P),F=n(55),H=n.n(F),D=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).socket=void 0,n.videoRef=void 0,n._closeRoom=Object(y.a)(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,I.showLoading("Closing Server"),e.next=5,M.closeRoom();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,I.hide(),t.replace("/sync"),e.finish(9);case 13:case"end":return e.stop()}},e,this,[[1,7,9,13]])})),n._setMedia=Object(y.a)(O.a.mark(function e(){var t,n,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.showChoice({title:"Select Media Type",confirmButtonText:"Online Media",cancelButtonText:"Local Media"});case 3:t=e.sent,e.t0=t,e.next=0===e.t0?7:1===e.t0?14:20;break;case 7:return e.next=9,I.showURLInput("Media URL");case 9:if(!(n=e.sent)){e.next=13;break}return e.next=13,M.setMedia({url:n});case 13:return e.abrupt("break",20);case 14:return(r=document.createElement("input")).type="file",r.accept="video/*",r.onchange=function(){var e=Object(y.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.files[0])){e.next=4;break}return e.next=4,M.setMedia({file:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r.click(),e.abrupt("break",20);case 20:e.next=24;break;case 22:e.prev=22,e.t1=e.catch(0);case 24:case"end":return e.stop()}},e,this,[[0,22]])})),n._setupSocketListener=Object(y.a)(O.a.mark(function e(){var t,r,a,o,c,s;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,r=t.history,a=t.location,o=t.match,c=a.state&&a.state.host,e.prev=2,e.next=5,M.getSocketURL(o.params.id);case 5:s=e.sent,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0),r.push("/sync",{roomDoesNotExist:!0});case 12:n.socket=H()(s),n.socket.on("pong",function(e){n.socket.emit("latency",{ping:e})}),n.socket.on("media",function(e){n.setState({url:e});var t=n.videoRef.current;t&&n._setupVideoElement(t)}),n.socket.on("play",function(){var e=n.videoRef.current;!c&&e&&e.play()}),n.socket.on("pause",function(){var e=n.videoRef.current;!c&&e&&e.pause()}),n.socket.on("mediaTime",function(e){var t=n.videoRef.current;if(!c&&t){switch(e.status){case"playing":t.paused&&t.play();break;case"paused":t.paused||t.pause()}var r=e.time-t.currentTime;Math.abs(r)>2&&(t.currentTime=e.time)}}),n.socket.on("users",function(e){n.setState({users:e.users})}),n.socket.on("closed",function(){r.push("/sync",a.state&&a.state.host&&{roomClosed:!0})}),c&&n.socket.emit("authenticate",{bearer:M.Bearer()});case 21:case"end":return e.stop()}},e,this,[[2,8]])})),n._setupVideoElement=function(e){var t=n.props.location;if(t.state&&t.state.host){e.onplay=Object(y.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.playMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger play event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])})),e.onpause=Object(y.a)(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.pauseMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger pause event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));var r=function(){var t=Object(y.a)(O.a.mark(function t(){return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,M.setMediaTime(e.currentTime);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Unable to trigger seek event:",t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}));return function(){return t.apply(this,arguments)}}();e.onseeking=r,e.ontimeupdate=r}},n.videoRef=a.a.createRef(),n.state={url:null,users:[]},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._setupSocketListener()}},{key:"componentWillUnmount",value:function(){this.socket&&this.socket.disconnect()}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.match,r=this.state,o=r.url,c=r.users;return a.a.createElement("div",{className:"full noScroll"},o?a.a.createElement("video",{style:{width:"80%",height:"100%",backgroundColor:"#000000",float:"left"},controls:!0,ref:this.videoRef,src:o}):a.a.createElement("div",{style:{width:"80%",height:"100%",backgroundColor:"#000000",float:"left"}}),a.a.createElement(V,{roomId:n.params.id,isHost:t.state&&t.state.host,setMedia:this._setMedia,closeRoom:this._closeRoom,users:c}))}}]),t}(r.Component),z=Object(b.a)(D),J=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"full"},a.a.createElement(f.a,null,a.a.createElement(m.a,null,a.a.createElement(d.a,{path:"/",exact:!0},a.a.createElement(v.a,{to:"/sync"})),a.a.createElement(d.a,{path:"/sync",exact:!0,component:A}),a.a.createElement(d.a,{path:"/sync/room/:id",exact:!0,component:z}),a.a.createElement(d.a,{path:"/",component:k}))))}}]),t}(r.Component),G=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.setMedia,n=e.closeRoom;return a.a.createElement("div",null,a.a.createElement("h4",{className:"light"},"Settings"),a.a.createElement(h,{title:"Set Media",onClick:t,light:!0,style:{marginRight:"1em"}}),a.a.createElement(h,{title:"Close Room",onClick:n,light:!0}))}}]),t}(r.Component),V=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roomId,n=e.isHost,r=e.setMedia,o=e.closeRoom,c=e.users;return a.a.createElement("div",{style:{width:"20%",height:"100%",backgroundColor:"#000000",float:"left",display:"flex",flexFlow:"column"}},a.a.createElement("h4",{className:"light"},"Room ID: ",t),n&&a.a.createElement(G,{setMedia:r,closeRoom:o}),a.a.createElement("h4",{className:"light"},"Viewers"),a.a.createElement(Y,{users:c}),a.a.createElement("h4",{className:"light"},"Chat"),a.a.createElement("div",{style:{width:"100%",overflowY:"scroll",backgroundColor:"#000000",flexGrow:1,display:"flex",flexFlow:"column"}}))}}]),t}(r.Component),Y=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.users;return a.a.createElement("div",{style:{width:"100%",maxHeight:"15%",backgroundColor:"#000000",overflowY:"scroll"}},e.map(function(e){return a.a.createElement("p",{key:e.id,style:{color:e.isHost?"#4caf50":"#FFFFFF"}},e.displayName," (",e.ping,")")}))}}]),t}(r.Component),K=n(56),W=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tooltip,n=e.component,r=Object(K.a)(e,["tooltip","component"]);return a.a.createElement("div",Object.assign({className:"tooltip"},r),n,a.a.createElement("span",{className:"tooltiptext"},t||""))}}]),t}(r.Component);n(110);c.a.render(a.a.createElement(J,null),document.getElementById("root"))},57:function(e,t,n){e.exports=n(111)}},[[57,1,2]]]);
//# sourceMappingURL=main.51fb4615.chunk.js.map