(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t){},110:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(31),c=n.n(o),s=n(4),i=n(5),u=n(7),l=n(6),p=n(8),h=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={clicked:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.onClick,r=e.style,o=this.props.disabled?"disabled":"",c=this.props.light?"light":"",s="button unselectable ".concat(o," ").concat(c);return a.a.createElement("div",{className:s,style:r,onClick:n},t)}}]),t}(r.Component),m=n(113),f=n(115),d=n(112),v=n(114),b=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._goHome=function(){n.props.history.replace("/")},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"centered"},a.a.createElement("h1",null,"404 - Page not found"),a.a.createElement("p",null,"It looks like you are lost"),a.a.createElement("div",null,a.a.createElement(h,{title:"Go Home",onClick:this._goHome})))}}]),t}(r.Component),k=Object(v.a)(b),w=n(1),x=n.n(w),y=n(3),O=n(13),j=n.n(O),g="http://localhost:8080",E=function(e){return"https://".concat(e,".ngrok.io")},C=new RegExp("//.[^.]*"),R=function(){return localStorage.getItem("bearer")},_={Bearer:R,closeRoom:function(){var e=Object(y.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=R(),localStorage.removeItem("bearer"),e.next=4,j()({url:"".concat(g,"/room/close"),method:"POST",headers:{Authorization:"Bearer ".concat(t)}});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),createRoom:function(){var e=Object(y.a)(x.a.mark(function e(){var t,n,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(g,"/room/create"),method:"POST"});case 3:return(t=e.sent).data.bearer&&localStorage.setItem("bearer",t.data.bearer),n=C.exec(t.data.url)||[],e.abrupt("return",n.join("").substr(2));case 9:e.prev=9,e.t0=e.catch(0),e.t1=e.t0.response.status,e.next=400===e.t1?14:16;break;case 14:return r=C.exec(e.t0.response.data.url)||[],e.abrupt("return",r.join("").substr(2));case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),getClientType:function(){var e=Object(y.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:g,method:"GET"});case 3:return t=e.sent,e.abrupt("return",200===t.status?"desktop":"web");case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","web");case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),getSocketURL:function(){var e=Object(y.a)(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(E(t),"/room/socketTunnel"),method:"GET"});case 3:return e.abrupt("return",E(t));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),setMedia:function(){var e=Object(y.a)(x.a.mark(function e(){var t,n,r,a,o=arguments;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{url:n,file:r},n=t.url,r=t.file,!n){e.next=6;break}return e.next=4,j()({url:"".concat(g,"/room/setMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:{url:n}});case 4:e.next=11;break;case 6:if(!r){e.next=11;break}return(a=new FormData).append("media",r),e.next=11,j()({url:"".concat(g,"/room/uploadMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:a});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),playMedia:function(){var e=Object(y.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()({url:"".concat(g,"/room/playMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pauseMedia:function(){var e=Object(y.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()({url:"".concat(g,"/room/pauseMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setMediaTime:function(){var e=Object(y.a)(x.a.mark(function e(t){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()({url:"".concat(g,"/room/setMediaTime"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:{time:t}});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},T=n(52),M=n.n(T),S=n(53),N=n.n(S)()(M.a),B=function(e){N.fire(e)},I=function(){var e=Object(y.a)(x.a.mark(function e(t){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.fire(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L={hide:function(){N.close()},show:B,showAction:I,showChoice:function(){var e=Object(y.a)(x.a.mark(function e(){var t,n,r,a,o,c,s,i,u=arguments;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{title:n,text:r,confirmButtonText:o,cancelButtonText:s},n=t.title,r=t.text,a=t.confirmButtonText,o=void 0===a?"Confirm":a,c=t.cancelButtonText,s=void 0===c?"Cancel":c,e.next=3,I({title:n,text:r,type:"info",showCloseButton:!0,showCancelButton:!0,showConfirmButton:!0,cancelButtonText:s,confirmButtonText:o});case 3:return i=e.sent,e.abrupt("return",i.value?0:"cancel"===i.dismiss?1:-1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showAlert:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";B({title:e,text:t,type:"info"})},showError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";B({title:e,text:t,type:"error"})},showInput:function(){var e=Object(y.a)(x.a.mark(function e(t){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I({title:t,input:"text",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading";B({allowOutsideClick:!1,allowEscapeKey:!1,title:e,onOpen:function(){return N.showLoading()}})},showURLInput:function(){var e=Object(y.a)(x.a.mark(function e(t){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I({title:t,input:"url",inputPlaceholder:"URL",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},U=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._createRoom=Object(y.a)(x.a.mark(function e(){var t,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,L.showLoading(),e.next=5,_.createRoom();case 5:r=e.sent,t.push("/room/".concat(r),{host:!0}),L.hide(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),L.showError("Unable to Create Room");case 14:case"end":return e.stop()}},e,this,[[1,10]])})),n._joinRoom=Object(y.a)(x.a.mark(function e(){var t,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.next=3,L.showInput("Enter Room ID");case 3:if(!(r=e.sent)){e.next=17;break}return e.prev=5,L.showLoading(),e.next=9,_.getSocketURL(r);case 9:t.push("/room/".concat(r),{host:!1}),L.hide(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0),L.showError("Unable to Join Room","Please ensure the room id specified is correct");case 17:case"end":return e.stop()}},e,this,[[5,13]])})),n._setDisplayName=Object(y.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.showInput("New Display Name");case 2:(t=e.sent)&&t.trim().length&&window.localStorage.setItem("displayName",t.trim());case 4:case"end":return e.stop()}},e,this)})),n.state={web:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(x.a.mark(function e(){var t,n,r,a;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.history,(r=t.location).state&&(r.state.roomClosed?L.showAlert("Room Closed"):r.state.roomDoesNotExist&&L.showError("Unable to Join Room","Room does not exist!"),n.push("/")),e.prev=2,e.next=5,_.getClientType();case 5:a=e.sent,this.setState({web:"web"===a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.setState({web:!0});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.web;return a.a.createElement("div",{className:"full"},a.a.createElement("div",{className:"centered"},a.a.createElement("h1",null,"sync"),a.a.createElement("p",null,"The simplest way to watch media together"),a.a.createElement("div",null,a.a.createElement(h,{title:"Join",style:{marginRight:"1em"},onClick:this._joinRoom}),e?a.a.createElement(W,{tooltip:"You must be using the sync client to host a room.",component:a.a.createElement(h,{title:"Host",disabled:!0})}):a.a.createElement(h,{title:"Host",onClick:this._createRoom}))),a.a.createElement(h,{title:"Set Display Name",style:{position:"absolute",bottom:10,right:10},onClick:this._setDisplayName}))}}]),t}(r.Component),D=Object(v.a)(U),H=function(e){function t(e,n){var r;return Object(s.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this)))._socket=void 0,r._isHost=void 0,r._socket=e,r._isHost=n||!1,r.setupSocket(),n&&r.emitAuthenticationMessage(),r.emitDisplayName(),r}return Object(p.a)(t,e),Object(i.a)(t,[{key:"setupSocket",value:function(){var e=this;this._socket.on("pong",function(t){e._socket.emit("latency",{ping:t})}),this._socket.on("media",function(t){e.emit("media",t)}),this._socket.on("play",function(){e._isHost||e.emit("play")}),this._socket.on("pause",function(){e._isHost||e.emit("pause")}),this._socket.on("mediaTime",function(t){e.emit("mediaTime",t)}),this._socket.on("users",function(t){e.emit("users",t.users)}),this._socket.on("closed",function(){e.emit("closed")})}},{key:"emitAuthenticationMessage",value:function(){this._socket.emit("authenticate",{bearer:_.Bearer()})}},{key:"emitDisplayName",value:function(){var e=window.localStorage.getItem("displayName");e&&this._socket.emit("displayName",{displayName:e})}},{key:"disconnect",value:function(){this._socket.disconnect()}},{key:"socket",get:function(){return this._socket}}]),t}(n(54).EventEmitter),A=n(55),P=n.n(A),F=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).socket=void 0,n.videoRef=void 0,n._closeRoom=Object(y.a)(x.a.mark(function e(){var t;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,L.showLoading("Closing Server"),e.next=5,_.closeRoom();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,L.hide(),t.replace("/"),e.finish(9);case 13:case"end":return e.stop()}},e,this,[[1,7,9,13]])})),n._setMedia=Object(y.a)(x.a.mark(function e(){var t,n,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.showChoice({title:"Select Media Type",confirmButtonText:"Online Media",cancelButtonText:"Local Media"});case 3:t=e.sent,e.t0=t,e.next=0===e.t0?7:1===e.t0?14:20;break;case 7:return e.next=9,L.showURLInput("Media URL");case 9:if(!(n=e.sent)){e.next=13;break}return e.next=13,_.setMedia({url:n});case 13:return e.abrupt("break",20);case 14:return(r=document.createElement("input")).type="file",r.accept="video/*",r.onchange=function(){var e=Object(y.a)(x.a.mark(function e(t){var n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.files[0])){e.next=4;break}return e.next=4,_.setMedia({file:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),r.click(),e.abrupt("break",20);case 20:e.next=24;break;case 22:e.prev=22,e.t1=e.catch(0);case 24:case"end":return e.stop()}},e,this,[[0,22]])})),n._setupSocketListener=Object(y.a)(x.a.mark(function e(){var t,r,a,o,c,s;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,r=t.history,a=t.location,o=t.match,c=a.state&&a.state.host,e.prev=2,e.next=5,_.getSocketURL(o.params.id);case 5:s=e.sent,n.socket=new H(P()(s),c),n.socket.on("media",function(e){n.setState({url:e});var t=n.videoRef.current;t&&n._setupVideoElement(t)}),n.socket.on("play",function(){var e=n.videoRef.current;e&&e.play()}),n.socket.on("pause",function(){var e=n.videoRef.current;e&&e.pause()}),n.socket.on("mediaTime",function(e){var t=n.videoRef.current;if(t){var r=Math.abs(t.currentTime-e.time);(c&&r>1&&!t.seeking||r>2)&&(t.currentTime=e.time),c||("playing"===e.state&&t.paused?t.play():"paused"!==e.state||t.paused||t.pause())}}),n.socket.on("users",function(e){n.setState({users:e})}),n.socket.on("close",function(){r.push("/",a.state&&a.state.host&&{roomClosed:!0})}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.error(e.t0),r.push("/",{roomDoesNotExist:!0});case 19:case"end":return e.stop()}},e,this,[[2,15]])})),n._setupVideoElement=function(e){var t=n.props.location;if(t.state&&t.state.host){e.onplay=Object(y.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.playMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger play event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])})),e.onpause=Object(y.a)(x.a.mark(function e(){return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.pauseMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger pause event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));var r=function(){var t=Object(y.a)(x.a.mark(function t(){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_.setMediaTime(e.currentTime);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Unable to trigger seek event:",t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}));return function(){return t.apply(this,arguments)}}();e.onseeking=r,e.ontimeupdate=r}},n.videoRef=a.a.createRef(),n.state={url:null,users:[]},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._setupSocketListener()}},{key:"componentWillUnmount",value:function(){this.socket&&this.socket.disconnect()}},{key:"render",value:function(){var e=this.props,t=e.location,n=e.match,r=this.state,o=r.url,c=r.users;return a.a.createElement("div",{className:"full noScroll"},o?a.a.createElement("video",{style:{width:"80%",height:"100%",backgroundColor:"#000000",float:"left"},controls:!0,ref:this.videoRef,src:o}):a.a.createElement("div",{style:{width:"80%",height:"100%",backgroundColor:"#000000",float:"left"}}),a.a.createElement(V,{roomId:n.params.id,isHost:t.state&&t.state.host,setMedia:this._setMedia,closeRoom:this._closeRoom,users:c}))}}]),t}(r.Component),z=Object(v.a)(F),J=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"full"},a.a.createElement(m.a,null,a.a.createElement(f.a,null,a.a.createElement(d.a,{path:"/",exact:!0,component:D}),a.a.createElement(d.a,{path:"/sync",exact:!0,component:D}),a.a.createElement(d.a,{path:"/room/:id",exact:!0,component:z}),a.a.createElement(d.a,{path:"/",component:k}))))}}]),t}(r.Component),G=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.setMedia,n=e.closeRoom;return a.a.createElement("div",null,a.a.createElement("h4",{className:"light"},"Settings"),a.a.createElement(h,{title:"Set Media",onClick:t,light:!0,style:{marginRight:"1em"}}),a.a.createElement(h,{title:"Close Room",onClick:n,light:!0}))}}]),t}(r.Component),V=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roomId,n=e.isHost,r=e.setMedia,o=e.closeRoom,c=e.users;return a.a.createElement("div",{style:{width:"20%",height:"100%",backgroundColor:"#000000",float:"left",display:"flex",flexFlow:"column"}},a.a.createElement("h4",{className:"light"},"Room ID: ",t),n&&a.a.createElement(G,{setMedia:r,closeRoom:o}),a.a.createElement("h4",{className:"light"},"Viewers"),a.a.createElement(Y,{users:c}),a.a.createElement("h4",{className:"light"},"Chat"),a.a.createElement("div",{style:{width:"100%",overflowY:"scroll",backgroundColor:"#000000",flexGrow:1,display:"flex",flexFlow:"column"}}))}}]),t}(r.Component),Y=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.users;return a.a.createElement("div",{style:{width:"100%",maxHeight:"15%",backgroundColor:"#000000",overflowY:"scroll"}},e.map(function(e){return a.a.createElement("p",{key:e.id,style:{color:e.isHost?"#4caf50":"#FFFFFF"}},e.displayName," (",e.ping,")")}))}}]),t}(r.Component),K=n(56),W=function(e){function t(e){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tooltip,n=e.component,r=Object(K.a)(e,["tooltip","component"]);return a.a.createElement("div",Object.assign({className:"tooltip"},r),n,a.a.createElement("span",{className:"tooltiptext"},t||""))}}]),t}(r.Component);n(110);c.a.render(a.a.createElement(J,null),document.getElementById("root"))},57:function(e,t,n){e.exports=n(111)}},[[57,1,2]]]);
//# sourceMappingURL=main.604298d2.chunk.js.map