(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t){},110:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(31),s=n.n(o),c=n(4),i=n(5),u=n(7),l=n(6),p=n(8),h=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={clicked:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.onClick,a=e.style,o=this.props.disabled?"disabled":"",s=this.props.light?"light":"",c="button unselectable ".concat(o," ").concat(s);return r.a.createElement("div",{className:c,style:a,onClick:n},t)}}]),t}(a.Component),m=n(113),f=n(115),d=n(112),v=n(114),b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._goHome=function(){n.props.history.replace("/")},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"centered"},r.a.createElement("h1",null,"404 - Page not found"),r.a.createElement("p",null,"It looks like you are lost"),r.a.createElement("div",null,r.a.createElement(h,{title:"Go Home",onClick:this._goHome})))}}]),t}(a.Component),k=Object(v.a)(b),g=n(1),w=n.n(g),x=n(3),y=n(13),O=n.n(y),j="http://localhost:8080",E=function(e){return"https://".concat(e,".ngrok.io")},C=new RegExp("//.[^.]*"),R=function(){return localStorage.getItem("bearer")},S={Bearer:R,closeRoom:function(){var e=Object(x.a)(w.a.mark(function e(){var t;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=R(),localStorage.removeItem("bearer"),e.next=4,O()({url:"".concat(j,"/room/close"),method:"POST",headers:{Authorization:"Bearer ".concat(t)}});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),createRoom:function(){var e=Object(x.a)(w.a.mark(function e(){var t,n,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O()({url:"".concat(j,"/room/create"),method:"POST"});case 3:return(t=e.sent).data.bearer&&localStorage.setItem("bearer",t.data.bearer),n=C.exec(t.data.url)||[],e.abrupt("return",n.join("").substr(2));case 9:e.prev=9,e.t0=e.catch(0),e.t1=e.t0.response.status,e.next=400===e.t1?14:16;break;case 14:return a=C.exec(e.t0.response.data.url)||[],e.abrupt("return",a.join("").substr(2));case 16:throw e.t0;case 17:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}(),getClientType:function(){var e=Object(x.a)(w.a.mark(function e(){var t;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O()({url:j,method:"GET"});case 3:return t=e.sent,e.abrupt("return",200===t.status?"desktop":"web");case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","web");case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}(),getSocketURL:function(){var e=Object(x.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O()({url:"".concat(E(t),"/room/socketTunnel"),method:"GET"});case 3:return e.abrupt("return",E(t));case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),setMedia:function(){var e=Object(x.a)(w.a.mark(function e(){var t,n,a,r,o=arguments;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{url:n,file:a},n=t.url,a=t.file,!n){e.next=6;break}return e.next=4,O()({url:"".concat(j,"/room/setMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:{url:n}});case 4:e.next=11;break;case 6:if(!a){e.next=11;break}return(r=new FormData).append("media",a),e.next=11,O()({url:"".concat(j,"/room/uploadMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:r});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),playMedia:function(){var e=Object(x.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({url:"".concat(j,"/room/playMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),pauseMedia:function(){var e=Object(x.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({url:"".concat(j,"/room/pauseMedia"),method:"POST",headers:{Authorization:"Bearer ".concat(R())}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),setMediaTime:function(){var e=Object(x.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()({url:"".concat(j,"/room/setMediaTime"),method:"POST",headers:{Authorization:"Bearer ".concat(R())},data:{time:t}});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},M=n(52),_=n.n(M),T=n(53),N=n.n(T)()(_.a),B=function(e){N.fire(e)},I=function(){var e=Object(x.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.fire(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),L={hide:function(){N.close()},show:B,showAction:I,showChoice:function(){var e=Object(x.a)(w.a.mark(function e(){var t,n,a,r,o,s,c,i,u=arguments;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{title:n,text:a,confirmButtonText:o,cancelButtonText:c},n=t.title,a=t.text,r=t.confirmButtonText,o=void 0===r?"Confirm":r,s=t.cancelButtonText,c=void 0===s?"Cancel":s,e.next=3,I({title:n,text:a,type:"info",showCloseButton:!0,showCancelButton:!0,showConfirmButton:!0,cancelButtonText:c,confirmButtonText:o});case 3:return i=e.sent,e.abrupt("return",i.value?0:"cancel"===i.dismiss?1:-1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showAlert:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";B({title:e,text:t,type:"info"})},showError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";B({title:e,text:t,type:"error"})},showInput:function(){var e=Object(x.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I({title:t,input:"text",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading";B({allowOutsideClick:!1,allowEscapeKey:!1,title:e,onOpen:function(){return N.showLoading()}})},showURLInput:function(){var e=Object(x.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I({title:t,input:"url",inputPlaceholder:"URL",showCancelButton:!0});case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e)))._createRoom=Object(x.a)(w.a.mark(function e(){var t,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,L.showLoading(),e.next=5,S.createRoom();case 5:a=e.sent,t.push("/room/".concat(a),{host:!0}),L.hide(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0),L.showError("Unable to Create Room");case 14:case"end":return e.stop()}},e,this,[[1,10]])})),n._joinRoom=Object(x.a)(w.a.mark(function e(){var t,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.next=3,L.showInput("Enter Room ID");case 3:if(!(a=e.sent)){e.next=17;break}return e.prev=5,L.showLoading(),e.next=9,S.getSocketURL(a);case 9:t.push("/room/".concat(a),{host:!1}),L.hide(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0),L.showError("Unable to Join Room","Please ensure the room id specified is correct");case 17:case"end":return e.stop()}},e,this,[[5,13]])})),n._setDisplayName=Object(x.a)(w.a.mark(function e(){var t;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.showInput("New Display Name");case 2:(t=e.sent)&&t.trim().length&&window.localStorage.setItem("displayName",t.trim());case 4:case"end":return e.stop()}},e,this)})),n.state={web:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(x.a)(w.a.mark(function e(){var t,n,a,r;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.history,(a=t.location).state&&(a.state.roomClosed?L.showAlert("Room Closed"):a.state.roomDoesNotExist&&L.showError("Unable to Join Room","Room does not exist!"),n.push("/")),e.prev=2,e.next=5,S.getClientType();case 5:r=e.sent,this.setState({web:"web"===r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.setState({web:!0});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.web;return r.a.createElement("div",{className:"full"},r.a.createElement("div",{className:"centered"},r.a.createElement("h1",null,"sync"),r.a.createElement("p",null,"The simplest way to watch media together"),r.a.createElement("div",null,r.a.createElement(h,{title:"Join",style:{marginRight:"1em"},onClick:this._joinRoom}),e?r.a.createElement(W,{tooltip:"You must be using the sync client to host a room.",component:r.a.createElement(h,{title:"Host",disabled:!0})}):r.a.createElement(h,{title:"Host",onClick:this._createRoom}))),r.a.createElement(h,{title:"Set Display Name",style:{position:"absolute",bottom:10,right:10},onClick:this._setDisplayName}))}}]),t}(a.Component),H=Object(v.a)(D),U=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this)))._socket=void 0,a._isHost=void 0,a._socket=e,a._isHost=n||!1,a.setupSocket(),n&&a.emitAuthenticationMessage(),a.emitDisplayName(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"setupSocket",value:function(){var e=this;this._socket.on("pong",function(t){e._socket.emit("latency",{ping:t})}),this._socket.on("media",function(t){e.emit("media",t)}),this._socket.on("play",function(){e._isHost||e.emit("play")}),this._socket.on("pause",function(){e._isHost||e.emit("pause")}),this._socket.on("mediaTime",function(t){e.emit("mediaTime",t)}),this._socket.on("users",function(t){e.emit("users",t.users)}),this._socket.on("message",function(t){e.emit("message",t.message)}),this._socket.on("messages",function(t){t.messages.forEach(function(t){e.emit("message",t)})}),this._socket.on("closed",function(){e.emit("closed")})}},{key:"emitAuthenticationMessage",value:function(){this._socket.emit("authenticate",{bearer:S.Bearer()})}},{key:"emitDisplayName",value:function(){var e=window.localStorage.getItem("displayName");e&&this._socket.emit("displayName",{displayName:e})}},{key:"sendMessage",value:function(e){this._socket.emit("message",{message:e})}},{key:"disconnect",value:function(){this._socket.disconnect()}},{key:"socket",get:function(){return this._socket}}]),t}(n(54).EventEmitter),A=n(55),F=n.n(A),P=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).socket=void 0,n.videoRef=void 0,n._closeRoom=Object(x.a)(w.a.mark(function e(){var t;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props.history,e.prev=1,L.showLoading("Closing Server"),e.next=5,S.closeRoom();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,L.hide(),t.replace("/"),e.finish(9);case 13:case"end":return e.stop()}},e,this,[[1,7,9,13]])})),n._setMedia=Object(x.a)(w.a.mark(function e(){var t,n,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.showChoice({title:"Select Media Type",confirmButtonText:"Online Media",cancelButtonText:"Local Media"});case 3:t=e.sent,e.t0=t,e.next=0===e.t0?7:1===e.t0?14:20;break;case 7:return e.next=9,L.showURLInput("Media URL");case 9:if(!(n=e.sent)){e.next=13;break}return e.next=13,S.setMedia({url:n});case 13:return e.abrupt("break",20);case 14:return(a=document.createElement("input")).type="file",a.accept="video/*",a.onchange=function(){var e=Object(x.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.target.files[0])){e.next=4;break}return e.next=4,S.setMedia({file:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.click(),e.abrupt("break",20);case 20:e.next=24;break;case 22:e.prev=22,e.t1=e.catch(0);case 24:case"end":return e.stop()}},e,this,[[0,22]])})),n._setupSocketListener=Object(x.a)(w.a.mark(function e(){var t,a,r,o,s,c;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.props,a=t.history,r=t.location,o=t.match,s=r.state&&r.state.host,e.prev=2,e.next=5,S.getSocketURL(o.params.id);case 5:c=e.sent,n.socket=new U(F()(c),s),n.socket.on("media",function(e){n.setState({url:e});var t=n.videoRef.current;t&&n._setupVideoElement(t)}),n.socket.on("play",function(){var e=n.videoRef.current;e&&e.play()}),n.socket.on("pause",function(){var e=n.videoRef.current;e&&e.pause()}),n.socket.on("mediaTime",function(e){var t=n.videoRef.current;if(t){var a=Math.abs(t.currentTime-e.time);(s&&a>1&&!t.seeking||a>2)&&(t.currentTime=e.time),s||("playing"===e.state&&t.paused?t.play():"paused"!==e.state||t.paused||t.pause())}}),n.socket.on("users",function(e){n.setState({users:e})}),n.socket.on("message",function(e){var t=n.state.messages;t.push(e),n.setState({messages:t})}),n.socket.on("close",function(){a.push("/",r.state&&r.state.host&&{roomClosed:!0})}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error(e.t0),a.push("/",{roomDoesNotExist:!0});case 20:case"end":return e.stop()}},e,this,[[2,16]])})),n._setupVideoElement=function(e){var t=n.props.location;if(t.state&&t.state.host){e.onplay=Object(x.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.playMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger play event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])})),e.onpause=Object(x.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.pauseMedia();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("Unable to trigger pause event:",e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));var a=function(){var t=Object(x.a)(w.a.mark(function t(){return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.setMediaTime(e.currentTime);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("Unable to trigger seek event:",t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}));return function(){return t.apply(this,arguments)}}();e.onseeking=a,e.ontimeupdate=a}},n.videoRef=r.a.createRef(),n.state={url:null,users:[],messages:[]},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._setupSocketListener()}},{key:"componentWillUnmount",value:function(){this.socket&&this.socket.disconnect()}},{key:"render",value:function(){var e=this,t=this.props,n=t.location,a=t.match,o=this.state,s=o.url,c=o.users,i=o.messages;return r.a.createElement("div",{className:"full noScroll"},s?r.a.createElement("video",{style:{width:"80%",height:"100%",backgroundColor:"#000000",float:"left"},controls:!0,ref:this.videoRef,src:s}):r.a.createElement("div",{style:{width:this.socket?"80%":"100%",height:"100%",backgroundColor:"#000000",float:"left"}}),this.socket&&r.a.createElement(V,{roomId:a.params.id,isHost:n.state&&n.state.host,setMedia:this._setMedia,closeRoom:this._closeRoom,sendMessage:function(t){return e.socket.sendMessage(t)},users:c,messages:i}))}}]),t}(a.Component),z=Object(v.a)(P),G=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"full"},r.a.createElement(m.a,null,r.a.createElement(f.a,null,r.a.createElement(d.a,{path:"/",exact:!0,component:H}),r.a.createElement(d.a,{path:"/sync",exact:!0,component:H}),r.a.createElement(d.a,{path:"/room/:id",exact:!0,component:z}),r.a.createElement(d.a,{path:"/",component:k}))))}}]),t}(a.Component),J=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.setMedia,n=e.closeRoom;return r.a.createElement("div",null,r.a.createElement("h4",{className:"light"},"Settings"),r.a.createElement(h,{title:"Set Media",onClick:t,light:!0,style:{marginRight:"1em"}}),r.a.createElement(h,{title:"Close Room",onClick:n,light:!0}))}}]),t}(a.Component),V=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={message:"",isSendingMessage:!1},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.roomId,a=t.isHost,o=t.setMedia,s=t.closeRoom,c=t.sendMessage,i=t.users,u=t.messages,l=this.state,p=l.message,h=l.isSendingMessage;return r.a.createElement("div",{style:{width:"20%",height:"100%",backgroundColor:"#000000",float:"left",display:"flex",flexFlow:"column"}},r.a.createElement("h4",{className:"light"},"Room ID: ",n),a&&r.a.createElement(J,{setMedia:o,closeRoom:s}),r.a.createElement("h4",{className:"light"},"Viewers"),r.a.createElement(Y,{users:i}),r.a.createElement("h4",{className:"light"},"Chat"),r.a.createElement("div",{style:{width:"100%",backgroundColor:"#000000",flexGrow:1,display:"flex",flexFlow:"column"}},r.a.createElement("div",{style:{flexGrow:1,backgroundColor:"#000000",overflowY:"scroll",display:"flex",flexFlow:"column",maxHeight:"100%"}},u.map(function(e){return r.a.createElement("p",{key:e.id,style:{color:"#ffffff",margin:0}},e.sender,": ",e.body)})),r.a.createElement("input",{type:"text",placeholder:"Send a message...",style:{backgroundColor:"#000000",color:h?"grey":"#ffffff",border:0,padding:7.5,fontSize:16,display:"flex"},disabled:h,value:p,onChange:function(t){return e.setState({message:t.target.value})},onKeyDown:function(){var t=Object(x.a)(w.a.mark(function t(n){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=p.trim(),"Enter"===n.key&&a.length&&(e.setState({isSendingMessage:!0}),c(p),setTimeout(function(){e.setState({message:"",isSendingMessage:!1})},250));case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()})))}}]),t}(a.Component),Y=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.users;return r.a.createElement("div",{style:{width:"100%",maxHeight:"15%",backgroundColor:"#000000",overflowY:"scroll"}},e.map(function(e){return r.a.createElement("p",{key:e.id,style:{color:e.isHost?"#4caf50":"#FFFFFF"}},e.displayName," (",e.ping,")")}))}}]),t}(a.Component),K=n(56),W=function(e){function t(e){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).call(this,e))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tooltip,n=e.component,a=Object(K.a)(e,["tooltip","component"]);return r.a.createElement("div",Object.assign({className:"tooltip"},a),n,r.a.createElement("span",{className:"tooltiptext"},t||""))}}]),t}(a.Component);n(110);s.a.render(r.a.createElement(G,null),document.getElementById("root"))},57:function(e,t,n){e.exports=n(111)}},[[57,1,2]]]);
//# sourceMappingURL=main.19cd2704.chunk.js.map